require=function t(e,a,r){function n(o,s){if(!a[o]){if(!e[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=a[o]={exports:{}};e[o][0].call(u.exports,function(t){var a=e[o][1][t];return n(a?a:t)},u,u.exports,t,e,a,r)}return a[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(){$.fn.formCheck=function(t,e){function a(t,a){for(j in a)if(e.rules[a[j].type]&&e.rules[a[j].type](t,a[j]))a[j].showSuccess?a[j].showSuccess():e.showSuccess&&e.showSuccess($(t),a[j].errMsg);else{if(a[j].showError){a[j].showError(),r=!1;break}if(e.showError){e.showError($(t),a[j].errMsg),r=!1;break}if(a[j].errMsg)return alert(a[j].errMsg),!1}return!0}e||(e={}),e.rules=$.extend({"null":function(t){return $.trim($(t).val()).length>0},select:function(t,e){return $(t).val()!=e.value},checked:function(t){return t.checked},maxlength:function(t,e){return $.trim($(t).val()).length<=e.maxlength},minlength:function(t,e){return $.trim($(t).val()).length>=e.minlength},digitMinlength:function(t,e){return $.trim($(t).val().replace(/[^0-9]/g,"")).length>=e.minlength},user:function(t){return/^[a-zA-Z0-9]{3,10}$/.test($.trim($(t).val()))},password:function(t){return/^(?!\d)[a-zA-Z0-9_]{6,16}$/.test($.trim($(t).val()))},rePpassword:function(t,e){return $.trim($(t).val())==$.trim($(e.compare).val())},email:function(t){return/(\,|^)([\w+._]+@\w+\.(\w+\.){0,3}\w{2,4})/.test($(t).val().replace(/-|\//g,""))},phone:function(t,e){return/^[\d-\s]{1,20}$/.test($(t).val())&&$.trim($(t).val()).replace(/[\s]+/g," ").length<=e.maxlength},number:function(t){return/^[0-9]+$/.test($.trim($(t).val()))}},e.rules);var r=!0;for(i=0;i<this[0].length;i++)if(!($(this[0][i]).attr("name")&&0==$(this[0][i]).attr("name").length||$(this[0][i]).prop("disabled"))){var n=t[$(this[0][i]).attr("name")];if(n&&!a(this[0][i],n))return!1}return r}},{}],2:[function(){!function(t){"use strict";function e(e){var a=e.data;e.isDefaultPrevented()||(e.preventDefault(),t(e.target).ajaxSubmit(a))}function a(e){var a=e.target,r=t(a);if(!r.is("[type=submit],[type=image]")){var n=r.closest("[type=submit]");if(0===n.length)return;a=n[0]}var i=this;if(i.clk=a,"image"==a.type)if(void 0!==e.offsetX)i.clk_x=e.offsetX,i.clk_y=e.offsetY;else if("function"==typeof t.fn.offset){var o=r.offset();i.clk_x=e.pageX-o.left,i.clk_y=e.pageY-o.top}else i.clk_x=e.pageX-a.offsetLeft,i.clk_y=e.pageY-a.offsetTop;setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)}function r(){if(t.fn.ajaxSubmit.debug){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}}var n={};n.fileapi=void 0!==t("<input type='file'/>").get(0).files,n.formdata=void 0!==window.FormData;var i=!!t.fn.prop;t.fn.attr2=function(){if(!i)return this.attr.apply(this,arguments);var t=this.prop.apply(this,arguments);return t&&t.jquery||"string"==typeof t?t:this.attr.apply(this,arguments)},t.fn.ajaxSubmit=function(e){function a(a){var r,n,i=t.param(a,e.traditional).split("&"),o=i.length,s=[];for(r=0;o>r;r++)i[r]=i[r].replace(/\+/g," "),n=i[r].split("="),s.push([decodeURIComponent(n[0]),decodeURIComponent(n[1])]);return s}function o(r){for(var n=new FormData,i=0;i<r.length;i++)n.append(r[i].name,r[i].value);if(e.extraData){var o=a(e.extraData);for(i=0;i<o.length;i++)o[i]&&n.append(o[i][0],o[i][1])}e.data=null;var s=t.extend(!0,{},t.ajaxSettings,e,{contentType:!1,processData:!1,cache:!1,type:l||"POST"});e.uploadProgress&&(s.xhr=function(){var a=t.ajaxSettings.xhr();return a.upload&&a.upload.addEventListener("progress",function(t){var a=0,r=t.loaded||t.position,n=t.total;t.lengthComputable&&(a=Math.ceil(r/n*100)),e.uploadProgress(t,r,n,a)},!1),a}),s.data=null;var c=s.beforeSend;return s.beforeSend=function(t,a){a.data=e.formData?e.formData:n,c&&c.call(this,t,a)},t.ajax(s)}function s(a){function n(t){var e=null;try{t.contentWindow&&(e=t.contentWindow.document)}catch(a){r("cannot get iframe.contentWindow document: "+a)}if(e)return e;try{e=t.contentDocument?t.contentDocument:t.document}catch(a){r("cannot get iframe.contentDocument: "+a),e=t.document}return e}function o(){function e(){try{var t=n(g).readyState;r("state = "+t),t&&"uninitialized"==t.toLowerCase()&&setTimeout(e,50)}catch(a){r("Server abort: ",a," (",a.name,")"),s(S),T&&clearTimeout(T),T=void 0}}var a=d.attr2("target"),i=d.attr2("action");k.setAttribute("target",m),(!l||/post/i.test(l))&&k.setAttribute("method","POST"),i!=f.url&&k.setAttribute("action",f.url),f.skipEncodingOverride||l&&!/post/i.test(l)||d.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),f.timeout&&(T=setTimeout(function(){w=!0,s($)},f.timeout));var o=[];try{if(f.extraData)for(var c in f.extraData)f.extraData.hasOwnProperty(c)&&(t.isPlainObject(f.extraData[c])&&f.extraData[c].hasOwnProperty("name")&&f.extraData[c].hasOwnProperty("value")?o.push(t('<input type="hidden" name="'+f.extraData[c].name+'">').val(f.extraData[c].value).appendTo(k)[0]):o.push(t('<input type="hidden" name="'+c+'">').val(f.extraData[c]).appendTo(k)[0]));f.iframeTarget||v.appendTo("body"),g.attachEvent?g.attachEvent("onload",s):g.addEventListener("load",s,!1),setTimeout(e,15);try{k.submit()}catch(u){var p=document.createElement("form").submit;p.apply(k)}}finally{k.setAttribute("action",i),a?k.setAttribute("target",a):d.removeAttr("target"),t(o).remove()}}function s(e){if(!b.aborted&&!O){if(E=n(g),E||(r("cannot access response document"),e=S),e===$&&b)return b.abort("timeout"),j.reject(b,"timeout"),void 0;if(e==S&&b)return b.abort("server abort"),j.reject(b,"error","server abort"),void 0;if(E&&E.location.href!=f.iframeSrc||w){g.detachEvent?g.detachEvent("onload",s):g.removeEventListener("load",s,!1);var a,i="success";try{if(w)throw"timeout";var o="xml"==f.dataType||E.XMLDocument||t.isXMLDoc(E);if(r("isXml="+o),!o&&window.opera&&(null===E.body||!E.body.innerHTML)&&--M)return r("requeing onLoad callback, DOM not available"),setTimeout(s,250),void 0;var l=E.body?E.body:E.documentElement;b.responseText=l?l.innerHTML:null,b.responseXML=E.XMLDocument?E.XMLDocument:E,o&&(f.dataType="xml"),b.getResponseHeader=function(t){var e={"content-type":f.dataType};return e[t.toLowerCase()]},l&&(b.status=Number(l.getAttribute("status"))||b.status,b.statusText=l.getAttribute("statusText")||b.statusText);var c=(f.dataType||"").toLowerCase(),u=/(json|script|text)/.test(c);if(u||f.textarea){var d=E.getElementsByTagName("textarea")[0];if(d)b.responseText=d.value,b.status=Number(d.getAttribute("status"))||b.status,b.statusText=d.getAttribute("statusText")||b.statusText;else if(u){var m=E.getElementsByTagName("pre")[0],h=E.getElementsByTagName("body")[0];m?b.responseText=m.textContent?m.textContent:m.innerText:h&&(b.responseText=h.textContent?h.textContent:h.innerText)}}else"xml"==c&&!b.responseXML&&b.responseText&&(b.responseXML=L(b.responseText));try{F=A(b,c,f)}catch(y){i="parsererror",b.error=a=y||i}}catch(y){r("error caught: ",y),i="error",b.error=a=y||i}b.aborted&&(r("upload aborted"),i=null),b.status&&(i=b.status>=200&&b.status<300||304===b.status?"success":"error"),"success"===i?(f.success&&f.success.call(f.context,F,"success",b),j.resolve(b.responseText,"success",b),p&&t.event.trigger("ajaxSuccess",[b,f])):i&&(void 0===a&&(a=b.statusText),f.error&&f.error.call(f.context,b,i,a),j.reject(b,"error",a),p&&t.event.trigger("ajaxError",[b,f,a])),p&&t.event.trigger("ajaxComplete",[b,f]),p&&!--t.active&&t.event.trigger("ajaxStop"),f.complete&&f.complete.call(f.context,b,i),O=!0,f.timeout&&clearTimeout(T),setTimeout(function(){f.iframeTarget?v.attr("src",f.iframeSrc):v.remove(),b.responseXML=null},100)}}}var c,u,f,p,m,v,g,b,y,x,w,T,k=d[0],j=t.Deferred();if(j.abort=function(t){b.abort(t)},a)for(u=0;u<h.length;u++)c=t(h[u]),i?c.prop("disabled",!1):c.removeAttr("disabled");if(f=t.extend(!0,{},t.ajaxSettings,e),f.context=f.context||f,m="jqFormIO"+(new Date).getTime(),f.iframeTarget?(v=t(f.iframeTarget),x=v.attr2("name"),x?m=x:v.attr2("name",m)):(v=t('<iframe name="'+m+'" src="'+f.iframeSrc+'" />'),v.css({position:"absolute",top:"-1000px",left:"-1000px"})),g=v[0],b={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var a="timeout"===e?"timeout":"aborted";r("aborting upload... "+a),this.aborted=1;try{g.contentWindow.document.execCommand&&g.contentWindow.document.execCommand("Stop")}catch(n){}v.attr("src",f.iframeSrc),b.error=a,f.error&&f.error.call(f.context,b,a,e),p&&t.event.trigger("ajaxError",[b,f,a]),f.complete&&f.complete.call(f.context,b,a)}},p=f.global,p&&0===t.active++&&t.event.trigger("ajaxStart"),p&&t.event.trigger("ajaxSend",[b,f]),f.beforeSend&&f.beforeSend.call(f.context,b,f)===!1)return f.global&&t.active--,j.reject(),j;if(b.aborted)return j.reject(),j;y=k.clk,y&&(x=y.name,x&&!y.disabled&&(f.extraData=f.extraData||{},f.extraData[x]=y.value,"image"==y.type&&(f.extraData[x+".x"]=k.clk_x,f.extraData[x+".y"]=k.clk_y)));var $=1,S=2,D=t("meta[name=csrf-token]").attr("content"),_=t("meta[name=csrf-param]").attr("content");_&&D&&(f.extraData=f.extraData||{},f.extraData[_]=D),f.forceSync?o():setTimeout(o,10);var F,E,O,M=50,L=t.parseXML||function(t,e){return window.ActiveXObject?(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml"),e&&e.documentElement&&"parsererror"!=e.documentElement.nodeName?e:null},C=t.parseJSON||function(t){return window.eval("("+t+")")},A=function(e,a,r){var n=e.getResponseHeader("content-type")||"",i="xml"===a||!a&&n.indexOf("xml")>=0,o=i?e.responseXML:e.responseText;return i&&"parsererror"===o.documentElement.nodeName&&t.error&&t.error("parsererror"),r&&r.dataFilter&&(o=r.dataFilter(o,a)),"string"==typeof o&&("json"===a||!a&&n.indexOf("json")>=0?o=C(o):("script"===a||!a&&n.indexOf("javascript")>=0)&&t.globalEval(o)),o};return j}if(!this.length)return r("ajaxSubmit: skipping submit process - no element selected"),this;var l,c,u,d=this;"function"==typeof e?e={success:e}:void 0===e&&(e={}),l=e.type||this.attr2("method"),c=e.url||this.attr2("action"),u="string"==typeof c?t.trim(c):"",u=u||window.location.href||"",u&&(u=(u.match(/^([^#]+)/)||[])[1]),e=t.extend(!0,{url:u,success:t.ajaxSettings.success,type:l||t.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},e);var f={};if(this.trigger("form-pre-serialize",[this,e,f]),f.veto)return r("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(e.beforeSerialize&&e.beforeSerialize(this,e)===!1)return r("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var p=e.traditional;void 0===p&&(p=t.ajaxSettings.traditional);var m,h=[],v=this.formToArray(e.semantic,h);if(e.data&&(e.extraData=e.data,m=t.param(e.data,p)),e.beforeSubmit&&e.beforeSubmit(v,this,e)===!1)return r("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[v,this,e,f]),f.veto)return r("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var g=t.param(v,p);m&&(g=g?g+"&"+m:m),"GET"==e.type.toUpperCase()?(e.url+=(e.url.indexOf("?")>=0?"&":"?")+g,e.data=null):e.data=g;var b=[];if(e.resetForm&&b.push(function(){d.resetForm()}),e.clearForm&&b.push(function(){d.clearForm(e.includeHidden)}),!e.dataType&&e.target){var y=e.success||function(){};b.push(function(a){var r=e.replaceTarget?"replaceWith":"html";t(e.target)[r](a).each(y,arguments)})}else e.success&&b.push(e.success);if(e.success=function(t,a,r){for(var n=e.context||this,i=0,o=b.length;o>i;i++)b[i].apply(n,[t,a,r||d,d])},e.error){var x=e.error;e.error=function(t,a,r){var n=e.context||this;x.apply(n,[t,a,r,d])}}if(e.complete){var w=e.complete;e.complete=function(t,a){var r=e.context||this;w.apply(r,[t,a,d])}}var T=t("input[type=file]:enabled",this).filter(function(){return""!==t(this).val()}),k=T.length>0,j="multipart/form-data",$=d.attr("enctype")==j||d.attr("encoding")==j,S=n.fileapi&&n.formdata;r("fileAPI :"+S);var D,_=(k||$)&&!S;e.iframe!==!1&&(e.iframe||_)?e.closeKeepAlive?t.get(e.closeKeepAlive,function(){D=s(v)}):D=s(v):D=(k||$)&&S?o(v):t.ajax(e),d.removeData("jqxhr").data("jqxhr",D);for(var F=0;F<h.length;F++)h[F]=null;return this.trigger("form-submit-notify",[this,e]),this},t.fn.ajaxForm=function(n){if(n=n||{},n.delegation=n.delegation&&t.isFunction(t.fn.on),!n.delegation&&0===this.length){var i={s:this.selector,c:this.context};return!t.isReady&&i.s?(r("DOM not ready, queuing ajaxForm"),t(function(){t(i.s,i.c).ajaxForm(n)}),this):(r("terminating; zero elements found by selector"+(t.isReady?"":" (DOM not ready)")),this)}return n.delegation?(t(document).off("submit.form-plugin",this.selector,e).off("click.form-plugin",this.selector,a).on("submit.form-plugin",this.selector,n,e).on("click.form-plugin",this.selector,n,a),this):this.ajaxFormUnbind().bind("submit.form-plugin",n,e).bind("click.form-plugin",n,a)},t.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},t.fn.formToArray=function(e,a){var r=[];if(0===this.length)return r;var i=this[0],o=e?i.getElementsByTagName("*"):i.elements;if(!o)return r;var s,l,c,u,d,f,p;for(s=0,f=o.length;f>s;s++)if(d=o[s],c=d.name,c&&!d.disabled)if(e&&i.clk&&"image"==d.type)i.clk==d&&(r.push({name:c,value:t(d).val(),type:d.type}),r.push({name:c+".x",value:i.clk_x},{name:c+".y",value:i.clk_y}));else if(u=t.fieldValue(d,!0),u&&u.constructor==Array)for(a&&a.push(d),l=0,p=u.length;p>l;l++)r.push({name:c,value:u[l]});else if(n.fileapi&&"file"==d.type){a&&a.push(d);var m=d.files;if(m.length)for(l=0;l<m.length;l++)r.push({name:c,value:m[l],type:d.type});else r.push({name:c,value:"",type:d.type})}else null!==u&&"undefined"!=typeof u&&(a&&a.push(d),r.push({name:c,value:u,type:d.type,required:d.required}));if(!e&&i.clk){var h=t(i.clk),v=h[0];c=v.name,c&&!v.disabled&&"image"==v.type&&(r.push({name:c,value:h.val()}),r.push({name:c+".x",value:i.clk_x},{name:c+".y",value:i.clk_y}))}return r},t.fn.formSerialize=function(e){return t.param(this.formToArray(e))},t.fn.fieldSerialize=function(e){var a=[];return this.each(function(){var r=this.name;if(r){var n=t.fieldValue(this,e);if(n&&n.constructor==Array)for(var i=0,o=n.length;o>i;i++)a.push({name:r,value:n[i]});else null!==n&&"undefined"!=typeof n&&a.push({name:this.name,value:n})}}),t.param(a)},t.fn.fieldValue=function(e){for(var a=[],r=0,n=this.length;n>r;r++){var i=this[r],o=t.fieldValue(i,e);null===o||"undefined"==typeof o||o.constructor==Array&&!o.length||(o.constructor==Array?t.merge(a,o):a.push(o))}return a},t.fieldValue=function(e,a){var r=e.name,n=e.type,i=e.tagName.toLowerCase();if(void 0===a&&(a=!0),a&&(!r||e.disabled||"reset"==n||"button"==n||("checkbox"==n||"radio"==n)&&!e.checked||("submit"==n||"image"==n)&&e.form&&e.form.clk!=e||"select"==i&&-1==e.selectedIndex))return null;if("select"==i){var o=e.selectedIndex;if(0>o)return null;for(var s=[],l=e.options,c="select-one"==n,u=c?o+1:l.length,d=c?o:0;u>d;d++){var f=l[d];if(f.selected){var p=f.value;if(p||(p=f.attributes&&f.attributes.value&&!f.attributes.value.specified?f.text:f.value),c)return p;s.push(p)}}return s}return t(e).val()},t.fn.clearForm=function(e){return this.each(function(){t("input,select,textarea",this).clearFields(e)})},t.fn.clearFields=t.fn.clearInputs=function(e){var a=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var r=this.type,n=this.tagName.toLowerCase();a.test(r)||"textarea"==n?this.value="":"checkbox"==r||"radio"==r?this.checked=!1:"select"==n?this.selectedIndex=-1:"file"==r?/MSIE/.test(navigator.userAgent)?t(this).replaceWith(t(this).clone(!0)):t(this).val(""):e&&(e===!0&&/hidden/.test(r)||"string"==typeof e&&t(this).is(e))&&(this.value="")})},t.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},t.fn.enable=function(t){return void 0===t&&(t=!0),this.each(function(){this.disabled=!t})},t.fn.selected=function(e){return void 0===e&&(e=!0),this.each(function(){var a=this.type;if("checkbox"==a||"radio"==a)this.checked=e;else if("option"==this.tagName.toLowerCase()){var r=t(this).parent("select");e&&r[0]&&"select-one"==r[0].type&&r.find("option").selected(!1),this.selected=e}})},t.fn.ajaxSubmit.debug=!1}("undefined"!=typeof jQuery?jQuery:window.Zepto)},{}],3:[function(t,e){e.exports={loading:'<img src="'+webData.IMG_PATH+'loading.gif" width="16" height="16">',success:'<i class="fa fa-check-circle"></i>',error:'<i class="fa fa-times-circle"></i>',tryAgain:"Opus！请刷新页面后再试一次~"}},{}],4:[function(t,e){function a(){}e.exports=new a,a.prototype.setEva=function(t){var e=encodeURI(location.href),a=document.getElementById("eva_"+t),r=document.getElementById("eva_count_"+t);$.ajax({type:"POST",url:webData.WEB_ROOT+"ajax.php",dataType:"json",data:{act:"setEva",book_id:t},success:function(t){if(0==t.code){var n=parseInt(r.innerText);1==t.isplus?(n++,a.className="eva eva_1"):(n--,a.className="eva"),r.innerHTML=n}else 1==t.code?location.href=webData.WEB_ROOT+"login.php?back="+e:alert("操作失败！")}})},a.prototype.delFile=function(t,e){$.ajax({type:"POST",url:webData.WEB_ROOT+"ajax.php",dataType:"text",data:{act:"delFile",book_id:t},success:function(t){1==parseInt(t)?e():alert("操作失败")}})}},{}],5:[function(){(function(t){define(function(e){var a="undefined"!=typeof window?window.$:"undefined"!=typeof t?t.$:null,r=e("./file"),n=new r;a(".eva").click(function(){var t=parseInt(a(this).attr("id").replace("eva_",""));n.setEva(t)}),a(".btnDelFile").click(function(){{var t=a(this),e=parseInt(a(this).attr("id").replace("del_",""));n.delFile(e,function(){t.closest("li").hide("fast")})}})})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./file":4}],6:[function(t,e){e.exports={init:function(){$("textarea").blur(function(){var t=$(this),e=t.val().replace(/\n\s*/g,"\n");e=e.replace(/\n{2,}/g,"\n"),t.val(e)})}}},{}],7:[function(t,e){e.exports={init:function(){$("#filterForm").submit(function(){return 0==$('input[name="ftype"]').val()&&0==$('input[name="fstyle"]').val()?(alert("请选择筛选条件"),!1):!0}),$("#keyForm").submit(function(){var t=$('input[name="sbkey"]').val();return t?!0:(alert("请输入关键字"),!1)})}}},{}],8:[function(){define(function(t){t("../mod/fileList")})},{"../mod/fileList":5}],9:[function(t,e){e.exports={init:function(){var e=t("../mod/config");$("body").on("click",".btn-like",function(){var t=$(this),a=t.attr("data-book-id"),r=t.hasClass("liked");$.ajax({type:"GET",url:webData.WEB_ROOT+"ajax.php",data:{act:"like",bookId:a,likeVal:r?0:1},dataType:"json",beforeSend:function(){t.prop("disabled",!0).children().hide().end().append(e.loading)},complete:function(){t.prop("disabled",!1).children("img").remove().end().children().show()},success:function(e){if(0===e.code)r?t.removeClass("liked").children("span").html("喜欢"):t.addClass("liked").children("span").html("取消");else if(1===e.code){alert(e.msg);var a=location.href,n=encodeURIComponent(a);window.location.href=webData.WEB_ROOT+"login.php?back="+n}}})})}}},{"../mod/config":3}],10:[function(t,e){e.exports={init:function(e){t("../lib/jqueryForm"),t("../lib/formCheck");var a=t("../mod/config"),r=$(document.getElementById(e+"Form")),n=r.find("#submitTip"),i=r.find('button[type="submit"]'),o=r.find('input[name="act"]'),s={"data[user_name]":[{type:"user",errMsg:"由3-10位英文字母或数字组成"}],"data[user_email]":[{type:"email",errMsg:"邮箱格式错误"}],"data[oldpwd]":[{type:"password",errMsg:"由6-16位下划线、英文字母或数字组成"}],"data[user_pwd]":[{type:"password",errMsg:"由6-16位下划线、英文字母或数字组成"}],"data[repwd]":[{type:"password",errMsg:"由6-16位下划线、英文字母或数字组成"},{type:"rePpassword",errMsg:"密码不一致",compare:r.find('input[name="data[user_pwd]"]')}]},l=function(t){"verifyNameAndEmail"==o.val()?(r.find(".tr-readonly input").prop("readonly",!0),r.find(".tr-disabled").show().find("input").prop("disabled",!1),o.val("verifyFindPwd"),r.find('input[name="data[user_id]"]').val(t.user_id)):location.href=webData.WEB_ROOT+"login.php?back="+t.back},c=function(t){n.addClass("success").html(a.success+t.msg),r.find('input[type="password"]').val(""),r.find('input[type="password"]').each(function(){$(this).val("");var t=$(this).closest("tr").find(".tip"),e=t.attr("data-tip");t.attr("class","tip").html(e)})};r.submit(function(){n.attr("class","tip").html("");var t=r.formCheck(s,{showSuccess:function(t){$(t).closest("tr").find(".tip").attr("class","tip success").html(a.success)},showError:function(t,e){$(t).closest("tr").find(".tip").attr("class","tip error").html(a.error+e)}});if(t&&"changePwd"==e){var o=r.find('input[name="data[oldpwd]"]').val(),u=r.find('input[name="data[user_pwd]"]').val();o==u&&(n.addClass("error").html(a.error+"新密码不能与旧密码相同"),t=!1)}if(t){var d={dataType:"json",beforeSubmit:function(){n.html(a.loading),i.prop("disabled",!0)},success:function(t){n.html(""),i.prop("disabled",!1),0==t.code?"forgetPwd"==e?l(t):"changePwd"==e?c(t):location.href=t.back:n.addClass("error").html(a.error+t.msg)},error:function(){n.addClass("error").html(a.error+a.tryAgain)}};r.ajaxSubmit(d)}return!1})}}},{"../lib/formCheck":1,"../lib/jqueryForm":2,"../mod/config":3}],11:[function(t,e){e.exports={init:function(){var t=$("#pendingList"),e=!1,a=function(){0==t.children("dl").length&&window.location.reload()},r=function(t){var r=$(t).closest("li"),n=r.closest(".list-b-box"),i=[r.attr("data-book-id")],o=n.find(".exist"),s=r.parent();$.ajax({type:"POST",url:webData.WEB_ROOT+"master/pending.php",dataType:"text",data:{act:"pass",bookIds:i},before:function(){e=!0},success:function(t){if(e=!1,1==parseInt(t))if(1===s.children("li").length)n.remove(),a();else{0==o.length&&(o=$('<ul class="exist"></ul>'),r.closest("dd").prepend("<hr>").prepend(o));var i=$('<li><i class="fa fa-angle-right"></i></li>');i.append(r.children("a")),o.append(i),r.remove()}else alert("操作失败")}})},n=function(t){var r=$(t).closest(".list-b-box"),n=[];r.find(".pending>li").each(function(t,e){n.push($(e).attr("data-book-id"))}),$.ajax({type:"POST",url:webData.WEB_ROOT+"master/pending.php",dataType:"text",data:{act:"pass",bookIds:n},before:function(){e=!0},success:function(t){e=!1,1==parseInt(t)?(r.remove(),a()):alert("操作失败")}})},i=function(t){var r=$(t).closest("li"),n=r.attr("data-book-id"),i=r.closest(".list-b-box"),o=r.parent();$.ajax({type:"POST",url:webData.WEB_ROOT+"master/pending.php",dataType:"text",data:{act:"repeat",bookId:n},before:function(){e=!0},success:function(t){e=!1,1==parseInt(t)?1===o.children("li").length?(i.remove(),a()):r.remove():alert("操作失败")}})};t.on("click",".btn-pass",function(){r($(this))}).on("click",".btn-batch-pass",function(){n($(this))}).on("click",".btn-repeat",function(){i($(this))})}}},{}],12:[function(t,e){t("../lib/jqueryForm"),t("../mod/textarea").init(),t("../lib/formCheck");var a=t("../mod/config"),r={attaForm:$("#attaForm"),attaInput:$("#attachment"),attaTip:$("#attaTip"),uploadForm:$("#uploadForm"),uploadBtn:$("#uploadBtn"),uploadTip:$("#uploadTip"),uploadTagsTip:$("#uploadTagsTip"),batchForm:$("#batchForm"),batchBtn:$("#batchBtn"),batchTip:$("#batchTip"),batchTagsTip:$("#batchTagsTip"),resultList:$("#resultList"),successResult:$("#uploadSuccess"),failResult:$("#uploadFail")},n=function(){r.attaInput.val(""),r.attaTip.html("")},i=function(){r.uploadBtn.prop("disabled",!1),r.uploadTip.html(""),r.uploadTagsTip.html(""),r.uploadForm.hide().get(0).reset(),r.batchForm.find('input[name="data[book_size]"]').val(""),r.batchForm.find('input[name="data[book_path]"]').val(""),r.batchBtn.prop("disabled",!1),r.batchTip.html(""),r.batchTagsTip.html(""),r.batchForm.hide().get(0).reset(),r.batchForm.find('input[name="data[files]"]').val("")},o=function(){r.resultList.hide(),r.successResult.hide(),r.failResult.hide()},s=function(t,e){var r='<div class="list-a"><hr class="mb4"><h3 class="error">'+a.error+" "+t+"</h3><table><thead><tr><th>文件路径</th><th>错误提示</th></tr></thead><tbody>";for(var n in e){var i=e[n];r+="<tr><td>"+i.book_path+"</td><td>"+i.msg+"</td></tr>"}return r+="</tbody></table></div>"},l=function(t,e){var r='<div class="list-a"><hr class="mb4"><h3 class="success">'+a.success+" "+t+"</h3><table><thead><tr><th>书名</th><th>作者</th><th>文件路径</th></tr></thead><tbody>";for(var n in e){var i=e[n];r+="<tr><td>"+i.book_name+"</td><td>"+i.book_author+"</td><td>"+i.book_path+"</td></tr>"}return r+="</tbody></table></div>"},c=function(){r.attaInput.mousedown(function(){i(),o()}),r.attaInput.change(function(){if(""==r.attaInput.val())return r.attaTip.attr("class","tip error").html(a.error+"请选择文件"),i(),o(),!1;r.attaTip.html("");var t={dataType:"json",success:function(t){if("illegal"==t.code)r.resultList.html(s(t.msg,t.illegal)).show();else if(0==t.code)if(t.isBatchUpload)r.resultList.html(l(t.msg,t.legal)).show(),r.batchForm.show().find('input[name="data[files]"]').val(JSON.stringify(t.legal));else{for(var e in t)-1!=e.indexOf("book_")&&r.uploadForm.find('input[name="data['+e+']"]').val(t[e]);r.attaTip.attr("class","tip success").html(a.success+t.msg),r.uploadForm.show()}else r.attaTip.attr("class","tip error").html(a.error+t.msg)}};r.attaForm.ajaxSubmit(t)})},u=function(){var t=r.uploadForm,e={"data[book_name]":[{type:"null",errMsg:"请刷新后重新上传"}],"data[book_author]":[{type:"null",errMsg:"请刷新后重新上传"}],"data[book_type]":[{type:"select",value:0,errMsg:"请选择分类"}]};t.submit(function(){var o=t.formCheck(e,{showSuccess:function(t){$(t).closest("tr").find(".tip").attr("class","tip success").html(a.success)},showError:function(t,e){$(t).closest("tr").find(".tip").attr("class","tip error").html(a.error+e)}});if(!o)return!1;if(t.find('input[name="data[book_tags][]"]:checked').length>5)return r.uploadTagsTip.attr("class","tip error").html(a.error+"标签不能超过5个"),!1;var s="editBook"!=t.find('input[name="act"]').val(),l={dataType:"json",beforeSubmit:function(){r.uploadTip.html(a.loading),r.uploadBtn.prop("disabled",!0)},success:function(e){s?(n(),i()):t.hide(),0==e.code?r.successResult.show():r.failResult.show()},error:function(){s?(n(),i()):t.hide(),r.failResult.show()}};return t.ajaxSubmit(l),!1})},d=function(){r.batchForm.submit(function(){var t=$(this);if(0==t.find('input[name="data[files]"]').val().length)return r.batchTip.attr("class","tip error").html(a.error+"获取附件信息出现问题，请重新上传"),!1;if(t.find('input[name="data[book_tags][]"]:checked').length>5)return r.uploadTagsTip.attr("class","tip error").html(a.error+"标签不能超过5个"),!1;var e={dataType:"json",beforeSubmit:function(){r.batchTip.html(a.loading),r.batchBtn.prop("disabled",!0)},success:function(t){n(),i(),r.resultList.hide(),0==t.code?r.successResult.show():r.failResult.show()},error:function(){n(),i(),r.resultList.hide(),r.failResult.show()}};return t.ajaxSubmit(e),!1})};e.exports={init:function(){c(),u(),d()}}},{"../lib/formCheck":1,"../lib/jqueryForm":2,"../mod/config":3,"../mod/textarea":6}],main:[function(t,e){var a=function(){var e=webData.dataKey?webData.dataKey:"";switch(e){case"index":t("./modules/index");break;case"browse":t("./modules/browse").init();break;case"onebook":t("./modules/like").init();break;case"upload":t("./modules/upload").init();break;case"login":t("./modules/login").init(e);break;case"register":t("./modules/login").init(e);break;case"forgetPwd":t("./modules/login").init(e);break;case"changePwd":t("./modules/login").init(e);break;case"pending":t("./modules/pending").init()}};e.exports={init:a}},{"./modules/browse":7,"./modules/index":8,"./modules/like":9,"./modules/login":10,"./modules/pending":11,"./modules/upload":12}]},{},[]);